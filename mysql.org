#+TITLE: MySQL
* Benutzung
** Data Query Language (DQL)

*** SHOW DATABASES
#+BEGIN_SRC sql
SHOW DATABASES;
#+END_SRC

*** USE
#+BEGIN_SRC sql
USE employees;
#+END_SRC

*** SHOW TABLES
#+BEGIN_SRC sql
SHOW TABLES;
#+END_SRC

*** DESCRIBE
#+BEGIN_SRC sql
DESCRIBE departments;
DESCRIBE dept_emp:
DESCRIBE dept_manager;
DESCRIBE employees;
DESCRIBE salaries;
DESCRIBE titles;
--views
DESCRIBE current_dept_emp;
DESCRIBE departments dept_emp_latest_date;
#+END_SRC

*** SELECT
#+BEGIN_SRC sql
--tables 
SELECT * FROM	departments;
SELECT * FROM	dept_emp;
SELECT * FROM	dept_manager;
SELECT * FROM	employees;
SELECT * FROM	salaries;
SELECT * FROM	titles;
--views
SELECT * FROM	current_dept_emp;
SELECT * FROM	dept_emp_latest_date;
#+END_SRC

#+BEGIN_SRC sql
SELECT
	emp_no,
	birth_date,
	first_name,
	last_name,
	gender,
	hire_date *
FROM
	employees;
#+END_SRC
*** DISTINCT
*** WHERE
*** AND
*** OR
*** LIMIT
*** IN
*** BETWEEN
*** LIKE
*** ORDER BY
*** ALIAS
*** JOIN
**** INNER JOIN
**** LEFT JOIN
**** RIGHT JOIN
**** CROSS JOIN
**** SELF JOIN
*** GROUP BY
*** HAVING
*** Subqueries
*** UNION
*** MINUS
*** INTERSECT
** Data Manipulation Language (DML)
*** INSERT
*** LAST_INSERT_ID Function
*** UPDATE
*** UPDATE JOIN
*** DELETE
*** DELETE JOIN
*** ON DELETE CASCADE
*** REPLACE
** Data Control Language (DCL)
** DTL (Data Transaction Language)
* Installation

** Installation unter Debian
#+BEGIN_SRC sh
sudo apt install mysql-server
#+END_SRC

** Installation unter Windows
...

* Konfiguration

** Benutzer und Rechte

*** Benutzer user@localhost mit dem Passwort password anlegen
#+BEGIN_SRC sql
CREATE USER 'user'@'localhost' IDENTIFIED BY 'password';
#+END_SRC

*** Aktuellen Benutzer anzeigen
#+BEGIN_SRC sql
SELECT USER();
#+END_SRC

*** Rechte eines Benutzers anzeigen
#+BEGIN_SRC sql
SHOW GRANTS;
#+END_SRC
#+BEGIN_SRC sql
SHOW GRANTS FOR 'root'@'localhost';
#+END_SRC

** Character Sets und Collations

*** Character Set und Collation anzeigen (global)
#+BEGIN_SRC sql
SELECT @@character_set_database, @@collation_database;
#+END_SRC

*** Character Set und Collation anzeigen (für eine Datenbank)
#+BEGIN_SRC sql
SELECT DEFAULT_CHARACTER_SET_NAME, DEFAULT_COLLATION_NAME
FROM INFORMATION_SCHEMA.SCHEMATA WHERE SCHEMA_NAME = 'db_name';
#+END_SRC

* Anwendung

* Monitoring

* Backups

** Logisches Backup mit /mysqldump/
Für das Erstellen eines Backups mit /mysqldump/ werden, je nach Anwendung verschiedene Rechte vorausgesetzt.
- SELECT zum Sichern von Tabellen
- SHOW VIEWS zum Sichern von Views
- TRIGGERS zum Sichern von Triggern
- LOCK TABLES zum Sperren von Tabellen
Für das Einspielen eines Backups mit /mysql/ ist das CREATE-Recht notwending.

*** Erstellen ein logischen Backups

**** Sichern einer Datenbank.
#+BEGIN_SRC sh
mysqldump db_name
#+END_SRC

**** Sichern mehrerer Tabellen einer Datenbank
#+BEGIN_SRC sh
mysqldump db_name tbl_name tb2_name...
#+END_SRC

**** Sichern aller Datenbanken
#+BEGIN_SRC sh
mysqldump --all-databases
#+END_SRC

*** Erstellen eines logischen Backups zur Datensicherung
#+BEGIN_SRC sh
mysqldump \
--user=root \
--all-databases \
--single-transaction \
--triggers \
--routines \
--events \
--hex-blob \
--no-data \
-r dump.sql
#+END_SRC

*** Erstellen eines logischen Backups ohne Daten
#+BEGIN_SRC sh
mysqldump \
--user=root \
--single-transaction \
--triggers \
--routines \
--events \
--hex-blob \
--no-data \
-r dump.sql \
db_name
#+END_SRC

*** Erstellen eines logischen Backups ohne CREATE-Statements
#+BEGIN_SRC sh
mysqldump \
--user=root \
--single-transaction \
--no-create-info=true \
-r dump.sql \
db_name
#+END_SRC

** Physikalisches Backup
...
